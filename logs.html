<head>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
	<style>
		summary {
			display: inline;
			cursor: pointer;
			text-decoration: underline;
		}
		details {
			display: inline;
		}
		.bold {
			font-weight: bold;
		}
		.bottom-right {
			position: fixed;
			bottom: 0;
			right: 0;
		}
	</style>
</head>

<h1>Logs</h1>

<div>Values can't be changed once entered</div>

<span class="bold">Nui</span>
<form action="/save/" method="POST">
	<span id="nui"></span>	
	<details id="nuied">
		<summary>[edit]</summary>
		<span>
			<input type="text" name="nui" placeholder="Time in minutes" />
			<input type="submit" value="Save">
		</span>
	</details>
</form>

<span class="bold">Forest</span>
<form action="/save/" method="POST">
	<span id="forest"></span>	
	<details id="forested">
		<summary>[edit]</summary>
		<span>
			<input type="text" name="forest" placeholder="Time in minutes" />
			<input type="submit" value="Save">
		</span>
	</details>
</form>

<span class="bold">Above the Castle</span>
<form action="/save/" method="POST">
	<span id="aboveCastle"></span>	
	<details id="atced">
		<summary>[edit]</summary>
		<span>
			<input type="text" name="aboveCastle" placeholder="Time in minutes" />
			<input type="submit" value="Save">
		</span>
	</details>
</form>

<span class="bold">Below the Castle</span>
<form action="/save/" method="POST">
	<span id="belowCastle"></span>	
	<details id="btced">
		<summary>[edit]</summary>
		<span>
			<input type="text" name="belowCastle" placeholder="Time in minutes" />
			<input type="submit" value="Save">
		</span>
	</details>
</form>

<div class="bottom-right">Source: </div>

<script>
	function formatTime(t) {
		if (~~(t / 3600) > 0) {
			var hour = ~~(t / 3600)
			var min  = ~~((t % 3600) / 60)
			var sec  = t % 60
			return hour + (min > 9 ? ":" : ":0") + min + (sec > 9 ? ":" : ":0") + sec;
		} else {
			var min = ~~(t / 60)
			var sec = t%60
			return min + (sec > 9 ? ":" : ":0") + sec 
		}
	}

	var nui = 0;
	var forest = 0;
	var atc = 0
	var btc = 0
	$(document).ready(function() {
		getFromDB();
		$("#nui").append(nui);
		$("#forest").append(forest);	
		$("#aboveCastle").append(atc);
		$("#belowCastle").append(btc);
		setInterval("getFromDB()", 10000);
		setInterval("countDown()", 1000);
	});
	function countDown() {
		if (nui >= 1) {
			nui--;
			$("#nui").html(formatTime(nui));
			$("#nuied").css("display","none");
		}
		if (nui == 0) {
			$("#nuied").css("display","inline");
		}
		if (forest >= 1) {
			forest--;
			$("#forest").html(formatTime(forest));
			$("#forested").css("display","none");
		}
		if (forest == 0) {
			$("#forested").css("display","inline");
		}
		if (atc >= 1) {
			atc--;
			$("#aboveCastle").html(formatTime(atc));
			$("#atced").css("display","none");
		}
		if (atc == 0) {
			$("#atced").css("display","inline");
		}
		if (btc >= 1) {
			btc--;
			$("#belowCastle").html(formatTime(btc));
			$("#btced").css("display","none");
		}
		if (btc == 0) {
			$("#btced").css("display","inline");
		}
	}
	function getFromDB() {
		$.post("/nuitimer", function(data, status) {
				nui = data;
			});
		$.post("/foresttimer", function(data, status) {
				forest = data;
			});
		$.post("/abovetimer", function(data, status) {
				atc = data;
			});
		$.post("/belowtimer", function(data, status) {
				btc = data;
			});
	}
</script>
